<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: objectIdentifier.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: objectIdentifier.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var url = require('url');
var util = require('util');


/** An identifier for an Azure Key Vault resource.
  * @class
  */
function ObjectIdentifier(collection, vault, name, version) {

  /** The vault URI.
    * @member {string}
    */
  this.vault = vault;

  /** The key name.
    * @member {string}
    */
  this.name = name;

  /** The key version. May be null.
    * @member {string}
    */
  this.version = version;

  /** The base identifier (i.e. without the version).
    * @member {string}
    */
  this.baseIdentifier = util.format('%s/%s/%s', vault, collection, name);

  /** The full identifier if a version was informed; otherwise is the same value of baseIdentifier.
    * @member {string}
    */
  this.identifier = version ? util.format('%s/%s', this.baseIdentifier, version) : this.baseIdentifier;
}

function createObjectIdentifier(collection, vault, name, version) {

  if (typeof collection != 'string' || !(collection = collection.trim())) {
    throw new Error('Invalid collection argument');
  }

  if (typeof vault != 'string' || !(vault = vault.trim())) {
    throw new Error('Invalid vault argument');
  }

  if (typeof name != 'string' || !(name = name.trim())) {
    throw new Error('Invalid name argument');
  }

  if (version &amp;&amp; typeof version != 'string') {
    throw new Error('Invalid version argument');
  }

  if (version) {
    version = version.trim();
  }

  if (!version) {
    version = null;
  }

  var baseUri;
  try {
    baseUri = url.parse(vault, true, true);
  } catch (e) {
    throw new Error(util.format('Invalid %s identifier: %s. Not a valid URI', collection, vault));
  }

  var vault = util.format('%s//%s', baseUri.protocol, baseUri.host);
  return new ObjectIdentifier(collection, vault, name, version);
}

function parseObjectIdentifier(collection, identifier) {

  if (typeof collection != 'string' || !(collection = collection.trim())) {
    throw new Error('Invalid collection argument');
  }

  if (typeof identifier != 'string' || !(identifier = identifier.trim())) {
    throw new Error('Invalid identifier argument');
  }

  var baseUri;
  try {
    baseUri = url.parse(identifier, true, true);
  } catch (e) {
    throw new Error(util.format('Invalid %s identifier: %s. Not a valid URI', collection, identifier));
  }

  // Path is of the form '/collection/name[/version]'
  var segments = baseUri.pathname.split('/');
  if (segments.length !== 3 &amp;&amp; segments.length !== 4) {
    throw new Error(util.format('Invalid %s identifier: %s. Bad number of segments: %d', collection, identifier, segments.length));
  }

  if (collection !== segments[1]) {
    throw new Error(util.format('Invalid %s identifier: %s. segment [1] should be "%s", found "%s"', collection, identifier, collection, segments[1]));
  }

  var vault = util.format('%s//%s', baseUri.protocol, baseUri.host);
  var name = segments[2];
  var version = segments.length === 4 ? segments[3] : null;
  return new ObjectIdentifier(collection, vault, name, version);
}

/** Creates an ObjectIdentifier object for a key.
 @param {string} vault The vault URI.
 @param {string} name The key name.
 @param {string} [version=null] The object version.
 @return {ObjectIdentifier} An object that represents the key identifier.
*/
module.exports.createKeyIdentifier = function (vault, name, version) {
    return createObjectIdentifier('keys', vault, name, version);
};

/** Parses a string containing a key identifier and returns the ObjectIdentifier object.
 @param {string} identifier The key identifier (an URI).
 @return {ObjectIdentifier} An object that represents the key identifier.
*/
module.exports.parseKeyIdentifier = function (identifier) {
    return parseObjectIdentifier('keys', identifier);
};

/** Creates an ObjectIdentifier object for a secret.
 @param {string} vault The vault URI.
 @param {string} name The secret name.
 @param {string} [version=null] The object version.
 @return {ObjectIdentifier} An object that represents the secret identifier.
*/
module.exports.createSecretIdentifier = function (vault, name, version) {
    return createObjectIdentifier('secrets', vault, name, version);
};

/** Parses a string containing a secret identifier and returns the ObjectIdentifier object.
 @param {string} identifier The secret identifier (an URI).
 @return {ObjectIdentifier} An object that represents the secret identifier.
*/
module.exports.parseSecretIdentifier = function (identifier) {
    return parseObjectIdentifier('secrets', identifier);
};

/** Creates an ObjectIdentifier object for a certificate.
 @param {string} vault The vault URI.
 @param {string} name The certificate name.
 @param {string} [version=null] The object version.
 @return {ObjectIdentifier} An object that represents the certificate identifier.
*/
module.exports.createCertificateIdentifier = function (vault, name, version) {
    return createObjectIdentifier('certificates', vault, name, version);
};

/** Parses a string containing a certificate identifier and returns the ObjectIdentifier object.
 @param {string} identifier The certificate identifier (an URI).
 @return {ObjectIdentifier} An object that represents the certificate identifier.
*/
module.exports.parseCertificateIdentifier = function (identifier) {
    return parseObjectIdentifier('certificates', identifier);
};

/** Creates an ObjectIdentifier object for a certificate operation.
 @param {string} vault The vault URI.
 @param {string} name The certificate name.
 @return {ObjectIdentifier} An object that represents the certificate identifier.
*/
module.exports.createCertificateOperationIdentifier = function (vault, name) {
    var objId = createObjectIdentifier('certificates', vault, name, 'pending');
    objId.baseIdentifier = objId.identifier;
    objId.version = null;
    return objId;
};

/** Parses a string containing a certificate identifier and returns the ObjectIdentifier object.
 @param {string} identifier The certificate identifier (an URI).
 @return {ObjectIdentifier} An object that represents the certificate identifier.
*/
module.exports.parseCertificateOperationIdentifier = function (identifier) {
    var objId = parseObjectIdentifier('certificates', identifier);
    objId.baseIdentifier = objId.identifier;
    objId.version = null;
    return objId;
};

/** Creates an ObjectIdentifier object for a certificate issuer.
 @param {string} vault The vault URI.
 @param {string} name The certificate issuer name.
 @return {ObjectIdentifier} An object that represents the certificate issuer identifier.
*/
module.exports.createIssuerIdentifier = function (vault, name) {
    return createObjectIdentifier('certificates/issuers', vault, name);
};

/** Parses a string containing a certificate issuer identifier and returns the ObjectIdentifier object.
 @param {string} identifier The certificate issuer identifier (an URI).
 @return {ObjectIdentifier} An object that represents the certificate issuer identifier.
*/
module.exports.parseIssuerIdentifier = function (identifier) {
    var baseUri;
    try {
        baseUri = url.parse(identifier, true, true);
    } catch (e) {
        throw new Error(util.format('Invalid %s identifier: %s. Not a valid URI', 'issuer', identifier));
    }
    
    // Path is of the form '/certificate/issuer/name'
    var segments = baseUri.pathname.split('/');
    if (segments.length !== 4) {
        throw new Error(util.format('Invalid %s identifier: %s. Bad number of segments: %d', 'issuer', identifier, segments.length));
    }
    
    if ('certificates' !== segments[1]) {
        throw new Error(util.format('Invalid %s identifier: %s. segment [1] should be "%s", found "%s"', 'issuer', identifier, 'certificates', segments[1]));
    }
    
    if ('issuers' !== segments[2]) {
        throw new Error(util.format('Invalid %s identifier: %s. segment [2] should be "%s", found "%s"', 'issuer', identifier, 'issuers', segments[1]));
    }
    
    var vault = util.format('%s//%s', baseUri.protocol, baseUri.host);
    var name = segments[3];
    return new ObjectIdentifier('certificates/issuers', vault, name, null);
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="-_.html"></a></li><li><a href="KeyVaultClient.html">KeyVaultClient</a></li><li><a href="KeyVaultCredentials.html">KeyVaultCredentials</a></li><li><a href="ObjectIdentifier.html">ObjectIdentifier</a></li><li><a href="The%2520attributes%2520of%2520a%2520key%2520managed%2520by%2520the%2520key%2520vault%2520service..html">The attributes of a key managed by the key vault service.</a></li><li><a href="The%2520certificate%2520management%2520attributes..html">The certificate management attributes.</a></li><li><a href="The%2520secret%2520management%2520attributes..html">The secret management attributes.</a></li></ul><h3>Namespaces</h3><ul><li><a href="JsonWebKeyEncryptionAlgorithms.html">JsonWebKeyEncryptionAlgorithms</a></li><li><a href="JsonWebKeySignatureAlgorithms.html">JsonWebKeySignatureAlgorithms</a></li><li><a href="JsonWebKeyType.html">JsonWebKeyType</a></li></ul><h3>Global</h3><ul><li><a href="global.html#_backupKey">_backupKey</a></li><li><a href="global.html#_createCertificate">_createCertificate</a></li><li><a href="global.html#_createKey">_createKey</a></li><li><a href="global.html#_decrypt">_decrypt</a></li><li><a href="global.html#_deleteCertificate">_deleteCertificate</a></li><li><a href="global.html#_deleteCertificateContacts">_deleteCertificateContacts</a></li><li><a href="global.html#_deleteCertificateIssuer">_deleteCertificateIssuer</a></li><li><a href="global.html#_deleteCertificateOperation">_deleteCertificateOperation</a></li><li><a href="global.html#_deleteKey">_deleteKey</a></li><li><a href="global.html#_deleteSecret">_deleteSecret</a></li><li><a href="global.html#_encrypt">_encrypt</a></li><li><a href="global.html#_getCertificate">_getCertificate</a></li><li><a href="global.html#_getCertificateContacts">_getCertificateContacts</a></li><li><a href="global.html#_getCertificateIssuer">_getCertificateIssuer</a></li><li><a href="global.html#_getCertificateIssuers">_getCertificateIssuers</a></li><li><a href="global.html#_getCertificateIssuersNext">_getCertificateIssuersNext</a></li><li><a href="global.html#_getCertificateOperation">_getCertificateOperation</a></li><li><a href="global.html#_getCertificatePolicy">_getCertificatePolicy</a></li><li><a href="global.html#_getCertificates">_getCertificates</a></li><li><a href="global.html#_getCertificatesNext">_getCertificatesNext</a></li><li><a href="global.html#_getCertificateVersions">_getCertificateVersions</a></li><li><a href="global.html#_getCertificateVersionsNext">_getCertificateVersionsNext</a></li><li><a href="global.html#_getKey">_getKey</a></li><li><a href="global.html#_getKeys">_getKeys</a></li><li><a href="global.html#_getKeysNext">_getKeysNext</a></li><li><a href="global.html#_getKeyVersions">_getKeyVersions</a></li><li><a href="global.html#_getKeyVersionsNext">_getKeyVersionsNext</a></li><li><a href="global.html#_getPendingCertificateSigningRequest">_getPendingCertificateSigningRequest</a></li><li><a href="global.html#_getSecret">_getSecret</a></li><li><a href="global.html#_getSecrets">_getSecrets</a></li><li><a href="global.html#_getSecretsNext">_getSecretsNext</a></li><li><a href="global.html#_getSecretVersions">_getSecretVersions</a></li><li><a href="global.html#_getSecretVersionsNext">_getSecretVersionsNext</a></li><li><a href="global.html#_importCertificate">_importCertificate</a></li><li><a href="global.html#_importKey">_importKey</a></li><li><a href="global.html#_mergeCertificate">_mergeCertificate</a></li><li><a href="global.html#_restoreKey">_restoreKey</a></li><li><a href="global.html#_setCertificateContacts">_setCertificateContacts</a></li><li><a href="global.html#_setCertificateIssuer">_setCertificateIssuer</a></li><li><a href="global.html#_setSecret">_setSecret</a></li><li><a href="global.html#_sign">_sign</a></li><li><a href="global.html#_unwrapKey">_unwrapKey</a></li><li><a href="global.html#_updateCertificate">_updateCertificate</a></li><li><a href="global.html#_updateCertificateIssuer">_updateCertificateIssuer</a></li><li><a href="global.html#_updateCertificateOperation">_updateCertificateOperation</a></li><li><a href="global.html#_updateCertificatePolicy">_updateCertificatePolicy</a></li><li><a href="global.html#_updateKey">_updateKey</a></li><li><a href="global.html#_updateSecret">_updateSecret</a></li><li><a href="global.html#_verify">_verify</a></li><li><a href="global.html#_wrapKey">_wrapKey</a></li><li><a href="global.html#actionType">actionType</a></li><li><a href="global.html#adminDetails">adminDetails</a></li><li><a href="global.html#attributes">attributes</a></li><li><a href="global.html#cancellationRequested">cancellationRequested</a></li><li><a href="global.html#certificateType">certificateType</a></li><li><a href="global.html#contactList">contactList</a></li><li><a href="global.html#contentType">contentType</a></li><li><a href="global.html#createCertificateIdentifier">createCertificateIdentifier</a></li><li><a href="global.html#createCertificateOperationIdentifier">createCertificateOperationIdentifier</a></li><li><a href="global.html#createIssuerIdentifier">createIssuerIdentifier</a></li><li><a href="global.html#createKeyIdentifier">createKeyIdentifier</a></li><li><a href="global.html#createKeyVaultClient">createKeyVaultClient</a></li><li><a href="global.html#createSecretIdentifier">createSecretIdentifier</a></li><li><a href="global.html#daysBeforeExpiry">daysBeforeExpiry</a></li><li><a href="global.html#innerError">innerError</a></li><li><a href="global.html#keyBundleBackup">keyBundleBackup</a></li><li><a href="global.html#managed">managed</a></li><li><a href="global.html#nextLink">nextLink</a></li><li><a href="global.html#parseCertificateIdentifier">parseCertificateIdentifier</a></li><li><a href="global.html#parseCertificateOperationIdentifier">parseCertificateOperationIdentifier</a></li><li><a href="global.html#parseIssuerIdentifier">parseIssuerIdentifier</a></li><li><a href="global.html#parseKeyIdentifier">parseKeyIdentifier</a></li><li><a href="global.html#parseSecretIdentifier">parseSecretIdentifier</a></li><li><a href="global.html#password">password</a></li><li><a href="global.html#phone">phone</a></li><li><a href="global.html#provider">provider</a></li><li><a href="global.html#requestId">requestId</a></li><li><a href="global.html#RESOURCE_ID">RESOURCE_ID</a></li><li><a href="global.html#result">result</a></li><li><a href="global.html#reuseKey">reuseKey</a></li><li><a href="global.html#secretAttributes">secretAttributes</a></li><li><a href="global.html#signature">signature</a></li><li><a href="global.html#t">t</a></li><li><a href="global.html#tags">tags</a></li><li><a href="global.html#updated">updated</a></li><li><a href="global.html#upns">upns</a></li><li><a href="global.html#validityInMonths">validityInMonths</a></li><li><a href="global.html#value">value</a></li><li><a href="global.html#x509Thumbprint">x509Thumbprint</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Jun 13 2017 09:57:27 GMT+0800 (China Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
